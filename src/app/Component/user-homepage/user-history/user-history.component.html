
<!--drop down to select P ya C, P ka mtlb Current hai C ka past-->

<div class="container mt-4">
  <div class="mb-3">
    <label for="historyTypeSelect" class="form-label fw-bold">Select Request Type: </label>
    <select
      id="historyTypeSelect"
      class="form-select w-auto d-inline-block"
      [(ngModel)]="historyType"
      (change)="onHistoryTypeChange(historyType)"
    >
      <option value="P" selected>Current Requests</option>
      <option value="C">Past Requests</option>
    </select>
  </div>
  <table id="myTable" class="display">
    <thead>
      <tr>
        <th>Name</th><th>Position</th><th>Office</th><th>Age</th><th>Start date</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let emp of employees">
        <td>{{ emp.name }}</td>
        <td>{{ emp.position }}</td>
        <td>{{ emp.office }}</td>
        <td>{{ emp.age }}</td>
        <td>{{ emp.startDate }}</td>
      </tr>
    </tbody>
  </table>
 <!--yaha se for loop laga ke data liya userHistory variable-->
 <div class="table-responsive shadow rounded">
  <!-- Table for ROLE_MP -->
  <table *ngIf="responseRole === 'ROLE_MP'" class="table table-hover table-bordered table-striped">
    <thead class="table-dark text-center">
      <tr>
        <th>EQ Request No.</th>
        <th>PNR</th>
        <th>Train No.</th>
        <th>Total Passengers</th>
        <th>Requested Passengers</th>
        <th>Accepted Passengers</th>
        <th>Current Status</th>
        <th>Remarks by Railways</th>
        <th>Created On</th>
      </tr>
    </thead>
    <tbody class="text-center">
      <tr *ngFor="let row of userHistory">
        <td>{{ row.eqRequestNo }}</td>
        <td>{{ row.pnr }}</td>
        <td>{{ row.trainNo }}</td>
        <td>{{ row.totalPassengers }}</td>
        <td>{{ row.requestPassengers }}</td>
        <td>{{ row.acceptedPassengers || "N/A" }}</td>
        <td>{{ row.currentStatus }}</td>
        <td>{{ row.remarks || "nil" }}</td>
        <td>{{ row.createdOn }}</td>
      </tr>
    </tbody>
  </table>

  <!-- Table for ROLE_AA -->
  <table *ngIf="responseRole == 'ROLE_AA' || responseRole == 'ROLE_RAILWAY'"  class="table table-hover table-bordered table-striped">
    <thead class="table-dark text-center">
      <tr>
        <th>EQ Request No.</th>
        <th>PNR</th>
        <th>Train No.</th>
        <th>Total Passengers</th>
        <th>Requested Passengers</th>
        <th>Accepted Passengers</th>
        <th>Current Status</th>
        <th>Remarks by Railways</th>
        <th>Created On</th>
        <!-- New Columns -->
        <th>Train Start Date</th>
        <th>Train Journey Date</th>
        <th>Source Station</th>
        <th>Destination</th>
        <th>Requested by</th>
        <th></th>
      </tr>
    </thead>
    <tbody class="text-center">
      <tr *ngFor="let row of userHistory">
        <td>{{ row.eqRequestNo }}</td>
        <td>{{ row.pnr }}</td>
        <td>{{ row.trainNo }}</td>
        <td>{{ row.totalPassengers }}</td>
        <td>{{ row.requestPassengers }}</td>
        <td>{{ row.acceptedPassengers || "N/A" }}</td>
        <td>{{ row.currentStatus }}</td>
        <td>{{ row.remarks || "nil" }}</td>
        <td>{{ row.createdOn }}</td>
        <td>{{ row.trainStartDate || "N/A" }}</td>
        <td>{{ row.jrnyDate || "N/A" }}</td>
        <td>{{ row.srcStation || "N/A" }}</td>
        <td>{{ row.destStation || "N/A" }}</td>
        <td>{{ row.mpName || "N/A" }}</td>
        <td>
          <button
            *ngIf="responseRole && row.assignedToAuthority && responseRole === row.assignedToAuthority"
            class="btn btn-primary btn-sm"
            (click)="takeAction(row.id)"
          >
            Take Action
          </button>
        </td>
      </tr>
    </tbody>
  </table>
</div>

</div>
